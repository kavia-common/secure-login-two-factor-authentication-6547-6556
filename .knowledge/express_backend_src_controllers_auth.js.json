{"is_source_file": true, "format": "JavaScript", "description": "This file defines express route handlers related to user authentication, including registration, login, 2FA initiation and verification, token refresh, and user info retrieval.", "external_files": ["../services/store", "../services/auth", "../services/twofa"], "external_methods": ["hashPassword", "verifyPassword", "signAccessToken", "signRefreshToken", "verifyRefreshToken", "initiateTwoFA", "verifyTwoFA"], "published": ["register", "login", "initiate2FA", "verify2FAController", "refresh", "me"], "classes": [], "methods": [{"name": "register(req, res)", "description": "Handles registration of a new user with username and password, returning the user's id and username upon success.", "scope": "", "scopeKind": ""}, {"name": "login(req, res)", "description": "Authenticates user credentials, issues access and refresh tokens. Indicates if 2FA is required.", "scope": "", "scopeKind": ""}, {"name": "initiate2FA(req, res)", "description": "Generates and sends a 2FA code for the authenticated user.", "scope": "", "scopeKind": ""}, {"name": "verify2FAController(req, res)", "description": "Verifies submitted 2FA code and issues a 2FA-validated access token.", "scope": "", "scopeKind": ""}, {"name": "refresh(req, res)", "description": "Uses a refresh token to issue a new access token, verifying validity and user existence.", "scope": "", "scopeKind": ""}, {"name": "me(req, res)", "description": "Returns basic info about the authenticated user, including 2FA status.", "scope": "", "scopeKind": ""}], "calls": ["store.createUser", "store.getUserByUsername", "storeService.addRefreshToken", "verifyPassword", "signAccessToken", "signRefreshToken", "verifyRefreshToken", "initiateTwoFA", "verifyTwoFA", "store.getRefreshToken", "store.getUserById"], "search-terms": ["auth.js", "Node.js", "Express route handlers", "2FA", "refresh token", "user registration", "login endpoint"], "state": 2, "file_id": 17, "knowledge_revision": 36, "git_revision": "", "ctags": [{"_type": "tag", "name": "initiate2FA", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/controllers/auth.js", "pattern": "/^async function initiate2FA(req, res) {$/", "language": "JavaScript", "kind": "function", "signature": "(req, res)"}, {"_type": "tag", "name": "login", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/controllers/auth.js", "pattern": "/^async function login(req, res) {$/", "language": "JavaScript", "kind": "function", "signature": "(req, res)"}, {"_type": "tag", "name": "me", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/controllers/auth.js", "pattern": "/^async function me(req, res) {$/", "language": "JavaScript", "kind": "function", "signature": "(req, res)"}, {"_type": "tag", "name": "refresh", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/controllers/auth.js", "pattern": "/^async function refresh(req, res) {$/", "language": "JavaScript", "kind": "function", "signature": "(req, res)"}, {"_type": "tag", "name": "register", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/controllers/auth.js", "pattern": "/^  register,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "register", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/controllers/auth.js", "pattern": "/^async function register(req, res) {$/", "language": "JavaScript", "kind": "function", "signature": "(req, res)"}, {"_type": "tag", "name": "store", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/controllers/auth.js", "pattern": "/^const store = require('..\\/services\\/store');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "verify2FAController", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/controllers/auth.js", "pattern": "/^async function verify2FAController(req, res) {$/", "language": "JavaScript", "kind": "function", "signature": "(req, res)"}], "hash": "b1c58e85aeef66cedc1051410483c391", "format-version": 4, "code-base-name": "express_backend", "filename": "express_backend/src/controllers/auth.js", "fields": [{"name": "register,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"36": ""}]}