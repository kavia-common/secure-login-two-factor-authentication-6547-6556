{"is_source_file": true, "format": "JavaScript", "description": "This file defines an in-memory store class for user data, 2FA codes, and refresh tokens, including methods for creation, retrieval, updating, and deletion of these data. It is part of the backend services for a secure login and two-factor authentication system.", "external_files": ["crypto"], "external_methods": ["crypto.randomUUID"], "published": ["createUser", "getUserByUsername", "getUserById", "upsertTwoFACode", "getTwoFACode", "deleteTwoFACode", "addRefreshToken", "getRefreshToken", "revokeRefreshToken"], "classes": [{"name": "Store", "description": "An in-memory data store for user credentials, 2FA codes, and refresh tokens used in authentication processes."}], "methods": [{"name": "createUser(username, passwordHash)", "description": "Creates a new user with a hashed password, assigns a unique ID, and initializes 2FA settings.", "scope": "Store", "scopeKind": "class"}, {"name": "getUserByUsername(username)", "description": "Retrieves a user object based on username.", "scope": "Store", "scopeKind": "class"}, {"name": "getUserById(userId)", "description": "Retrieves a user object based on user ID.", "scope": "Store", "scopeKind": "class"}, {"name": "upsertTwoFACode(userId, code, expiresAt)", "description": "Creates or updates a 2FA code for a user, setting an expiration and recording request time.", "scope": "Store", "scopeKind": "class"}, {"name": "getTwoFACode(userId)", "description": "Retrieves the current 2FA code information for a user.", "scope": "Store", "scopeKind": "class"}, {"name": "deleteTwoFACode(userId)", "description": "Deletes the 2FA code associated with a user.", "scope": "Store", "scopeKind": "class"}, {"name": "addRefreshToken(token, userId, expiresAt)", "description": "Stores a refresh token associated with a user ID and expiration time.", "scope": "Store", "scopeKind": "class"}, {"name": "getRefreshToken(token)", "description": "Retrieves refresh token details.", "scope": "Store", "scopeKind": "class"}, {"name": "revokeRefreshToken(token)", "description": "Removes a stored refresh token.", "scope": "Store", "scopeKind": "class"}, {"name": "constructor()", "scope": "Store", "scopeKind": "class", "description": "unavailable"}], "calls": ["crypto.randomUUID", "this.users.has", "this.users.set", "this.users.get", "this.twoFACodes.set", "this.twoFACodes.get", "this.twoFACodes.delete", "this.refreshTokens.set", "this.refreshTokens.get", "this.refreshTokens.delete"], "search-terms": ["InMemoryStore", "2FA", "refreshTokens", "user management"], "state": 2, "file_id": 13, "knowledge_revision": 28, "git_revision": "", "ctags": [{"_type": "tag", "name": "Store", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/store.js", "pattern": "/^class Store {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "addRefreshToken", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/store.js", "pattern": "/^  addRefreshToken(token, userId, expiresAt) {$/", "language": "JavaScript", "kind": "method", "signature": "(token, userId, expiresAt)", "scope": "Store", "scopeKind": "class"}, {"_type": "tag", "name": "constructor", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/store.js", "pattern": "/^  constructor() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "Store", "scopeKind": "class"}, {"_type": "tag", "name": "createUser", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/store.js", "pattern": "/^  createUser(username, passwordHash) {$/", "language": "JavaScript", "kind": "method", "signature": "(username, passwordHash)", "scope": "Store", "scopeKind": "class"}, {"_type": "tag", "name": "crypto", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/store.js", "pattern": "/^const crypto = require('crypto');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "deleteTwoFACode", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/store.js", "pattern": "/^  deleteTwoFACode(userId) {$/", "language": "JavaScript", "kind": "method", "signature": "(userId)", "scope": "Store", "scopeKind": "class"}, {"_type": "tag", "name": "exports", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/store.js", "pattern": "/^module.exports = new Store();$/", "language": "JavaScript", "kind": "variable", "scope": "module", "scopeKind": "class"}, {"_type": "tag", "name": "getRefreshToken", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/store.js", "pattern": "/^  getRefreshToken(token) {$/", "language": "JavaScript", "kind": "method", "signature": "(token)", "scope": "Store", "scopeKind": "class"}, {"_type": "tag", "name": "getTwoFACode", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/store.js", "pattern": "/^  getTwoFACode(userId) {$/", "language": "JavaScript", "kind": "method", "signature": "(userId)", "scope": "Store", "scopeKind": "class"}, {"_type": "tag", "name": "getUserById", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/store.js", "pattern": "/^  getUserById(userId) {$/", "language": "JavaScript", "kind": "method", "signature": "(userId)", "scope": "Store", "scopeKind": "class"}, {"_type": "tag", "name": "getUserByUsername", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/store.js", "pattern": "/^  getUserByUsername(username) {$/", "language": "JavaScript", "kind": "method", "signature": "(username)", "scope": "Store", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/store.js", "pattern": "/^    const user = { id, username, passwordHash, twoFA: { enabled: true }, lastLoginAt: null };$/", "language": "JavaScript", "kind": "field", "scope": "Store.createUser.user", "scopeKind": "class"}, {"_type": "tag", "name": "revokeRefreshToken", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/store.js", "pattern": "/^  revokeRefreshToken(token) {$/", "language": "JavaScript", "kind": "method", "signature": "(token)", "scope": "Store", "scopeKind": "class"}, {"_type": "tag", "name": "upsertTwoFACode", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/store.js", "pattern": "/^  upsertTwoFACode(userId, code, expiresAt) {$/", "language": "JavaScript", "kind": "method", "signature": "(userId, code, expiresAt)", "scope": "Store", "scopeKind": "class"}], "hash": "0088be0d31fd61468dd90d0de6a577e3", "format-version": 4, "code-base-name": "express_backend", "filename": "express_backend/src/services/store.js", "fields": [{"name": "module.exports = new Store();", "scope": "module", "scopeKind": "class", "description": "unavailable"}, {"name": "const user = { id, username, passwordHash, twoFA: { enabled: true }, lastLoginAt: null };", "scope": "Store.createUser.user", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"28": ""}]}