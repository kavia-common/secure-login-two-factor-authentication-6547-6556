{"is_source_file": true, "format": "JavaScript", "description": "This file implements two-factor authentication (2FA) services including code generation, rate limiting, code delivery, initiation, and verification. It manages per-user 2FA codes, enforces request limits, and provides interfaces for starting and verifying 2FA via console or external providers.", "external_files": ["./store"], "external_methods": ["store.upsertTwoFACode", "store.getTwoFACode", "store.deleteTwoFACode"], "published": ["initiateTwoFA", "verifyTwoFA"], "classes": [], "methods": [{"name": "canRequestCode(userId)", "description": "Checks if the user can request a new 2FA code based on rate limit.", "scope": "", "scopeKind": ""}, {"name": "canAttemptVerify(userId)", "description": "Checks if the user can attempt verification based on rate limit.", "scope": "", "scopeKind": ""}, {"name": "generateNumericCode(length)", "description": "Generates a numeric code of specified length.", "scope": "", "scopeKind": ""}, {"name": "deliverCode(user, code)", "description": "Delivers the 2FA code to the user via configured delivery mode.", "scope": "", "scopeKind": ""}, {"name": "initiateTwoFA(user)", "description": "Generates, stores, and delivers a 2FA code to the user, initiating the 2FA process.", "scope": "", "scopeKind": ""}, {"name": "verifyTwoFA(user, submittedCode)", "description": "Verifies a submitted 2FA code against stored code and handles expiration and attempt limits.", "scope": "", "scopeKind": ""}], "calls": ["store.upsertTwoFACode", "store.getTwoFACode", "store.deleteTwoFACode", "console.log"], "search-terms": ["twofa", "2FA", "rate limiting", "code generation", "verification", "public interface", "store"], "state": 2, "file_id": 15, "knowledge_revision": 32, "git_revision": "", "ctags": [{"_type": "tag", "name": "TWO_FA_CODE_LENGTH", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^const TWO_FA_CODE_LENGTH = parseInt(process.env.TWO_FA_CODE_LENGTH || '6', 10);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "TWO_FA_CODE_TTL", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^const TWO_FA_CODE_TTL = parseInt(process.env.TWO_FA_CODE_TTL || '300', 10); \\/\\/ seconds$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "TWO_FA_DELIVERY_MODE", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^const TWO_FA_DELIVERY_MODE = process.env.TWO_FA_DELIVERY_MODE || 'console';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "TWO_FA_MAX_REQUESTS_PER_HOUR", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^const TWO_FA_MAX_REQUESTS_PER_HOUR = parseInt(process.env.TWO_FA_MAX_REQUESTS_PER_HOUR || '5', 1/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "TWO_FA_MAX_VERIFY_ATTEMPTS_PER_HOUR", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^const TWO_FA_MAX_VERIFY_ATTEMPTS_PER_HOUR = parseInt(process.env.TWO_FA_MAX_VERIFY_ATTEMPTS_PER_/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "canAttemptVerify", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^function canAttemptVerify(userId) {$/", "language": "JavaScript", "kind": "function", "signature": "(userId)"}, {"_type": "tag", "name": "canRequestCode", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^function canRequestCode(userId) {$/", "language": "JavaScript", "kind": "function", "signature": "(userId)"}, {"_type": "tag", "name": "deliverCode", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^function deliverCode(user, code) {$/", "language": "JavaScript", "kind": "function", "signature": "(user, code)"}, {"_type": "tag", "name": "generateNumericCode", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^function generateNumericCode(length) {$/", "language": "JavaScript", "kind": "function", "signature": "(length)"}, {"_type": "tag", "name": "initiateTwoFA", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^  initiateTwoFA,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "initiateTwoFA", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^function initiateTwoFA(user) {$/", "language": "JavaScript", "kind": "function", "signature": "(user)"}, {"_type": "tag", "name": "requestWindow", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^const requestWindow = new Map(); \\/\\/ userId -> [timestamps]$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "store", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^const store = require('.\\/store');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "verifyTwoFA", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^function verifyTwoFA(user, submittedCode) {$/", "language": "JavaScript", "kind": "function", "signature": "(user, submittedCode)"}, {"_type": "tag", "name": "verifyWindow", "path": "/home/kavia/workspace/code-generation/secure-login-two-factor-authentication-6547-6556/express_backend/src/services/twofa.js", "pattern": "/^const verifyWindow = new Map(); \\/\\/ userId -> [timestamps]$/", "language": "JavaScript", "kind": "constant"}], "hash": "e35476668c8091178c461d7dd71bc6e5", "format-version": 4, "code-base-name": "express_backend", "filename": "express_backend/src/services/twofa.js", "fields": [{"name": "initiateTwoFA,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"32": ""}]}